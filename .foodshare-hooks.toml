# FoodShare Hooks Configuration (Cross-Platform)
# This file configures the foodshare-hooks CLI tool
# Supports both iOS (Swift/Xcode) and Android (Skip Fuse/Gradle)

[general]
# Swift version for formatting
swift_version = "6.1"

# Default Xcode scheme (iOS)
scheme = "FoodShare"

# Default simulator destination (iOS)
destination = "platform=iOS Simulator,name=iPhone 17 Pro Max"

# Default simulator device name (iOS)
device = "iPhone 17 Pro Max"

# App bundle identifier
bundle_id = "com.flutterflow.foodshare"

# Android package name
package_name = "com.foodshare"

# Paths to exclude from all operations
exclude_paths = [
    "**/Build/**",
    "**/DerivedData/**",
    "**/.build/**",
    "**/.gradle/**",
    "**/.idea/**",
    "**/Pods/**",
    "**/generated/**",
    "**/Android/app/build/**",
]

[format]
# Auto-stage formatted files
stage_fixed = true

# Paths to format (Swift sources)
paths = ["Sources/FoodShare"]

[lint]
# Enable strict mode by default
strict = false

# Reporter format (default, json, checkstyle)
reporter = "default"

# Paths to lint (Swift sources)
paths = ["Sources/FoodShare"]

[analyze]
# Thresholds for warnings
threshold_todos = 10
threshold_fixmes = 5
threshold_force_unwraps = 20

# Paths to analyze
paths = ["Sources/FoodShare"]

[secrets]
# Patterns to detect (regex, case-insensitive)
patterns = [
    "password",
    "api[_-]?key",
    "secret",
    "token",
    "credential",
    "private[_-]?key",
    "access[_-]?key",
    "auth[_-]?token",
    "bearer",
    "supabase.*key",
    "SUPABASE_.*KEY",
    "AWS_.*KEY",
    "OPENAI_API_KEY",
]

# Files to exclude from secret scanning
exclude_files = [
    ".lefthook.yml",
    "*.md",
    "Package.resolved",
    ".foodshare-hooks.toml",
    "Cargo.toml",
    "Cargo.lock",
    "*.pbxproj",
    "*.swift",
    "*.rs",
    "gradle.properties.template",
    "local.properties.template",
]

[commit_msg]
# Allowed commit types
types = ["feat", "fix", "docs", "style", "refactor", "test", "chore", "perf", "ci", "build", "revert"]

# Subject line length limits
max_length = 72
min_length = 10

# Skip validation for special commits
skip_merge = true
skip_revert = true

[version]
# iOS project file path
project_file = "Darwin/FoodShare.xcodeproj/project.pbxproj"

# Info.plist path
info_plist = "Darwin/Info.plist"

# Skip.env path (cross-platform version sync)
skip_env = "Skip.env"

# Android build file
build_file = "Android/app/build.gradle.kts"

# Version name pattern (Android)
version_name_key = "versionName"
version_code_key = "versionCode"

# Require version bump before release
require_bump = false

[test]
# Coverage threshold (percentage)
coverage_threshold = 70

# iOS test targets
unit_target = "FoodShareTests"
integration_target = "FoodShareIntegrationTests"
ui_target = "FoodShareUITests"

# Android test tasks
android_unit_task = "testDebugUnitTest"
android_integration_task = "connectedDebugAndroidTest"

# Results directory
results_dir = "TestResults"
android_results_dir = "Android/app/build/reports/tests"

[build]
# Clean before build
clean_first = false

# Treat warnings as errors
warnings_as_errors = false

[deps]
# Package.resolved path (iOS/Swift)
resolved_file = "Package.resolved"

[migrations]
# Migrations directory (shared with backend)
migrations_dir = "supabase/migrations"

[docs]
# Output directory
output_dir = "docs/api"

# Documentation coverage threshold
coverage_threshold = 50

# Module name
module = "FoodShare"

[clean]
# iOS paths to clean
derived_data = "~/Library/Developer/Xcode/DerivedData/FoodShare-*"
test_results = "TestResults"
build_dir = ".build"

# Android paths to clean
gradle_cache = "Android/.gradle"
android_build_dir = "Android/app/build"

# Deep clean additional paths
swift_cache = "~/Library/Caches/org.swift.swiftpm"
xcode_cache = "~/Library/Caches/com.apple.dt.Xcode"
kotlin_cache = "~/.gradle/caches"

# =============================================================================
# PRE-PUSH CONFIGURATION
# =============================================================================

[pre_push]
# Enable fail-fast by default (stop at first failure)
fail_fast = true

# Use Release configuration to match CI behavior
configuration = "Release"

# Default timeout per check in seconds
timeout = 300

# Checks to run in quick mode (fast validators only)
quick_checks = ["validate", "memory", "deps-graph", "version"]

# Checks to run in full mode (all checks)
full_checks = ["validate", "memory", "deps-graph", "version", "test", "build"]

# Checks that can run in parallel
parallel_checks = ["validate", "memory", "deps-graph", "version"]

# Checks that must run sequentially
sequential_checks = ["test", "build"]

[pre_push.timeouts]
# Per-check timeout overrides (seconds)
validate = 120
memory = 30
deps-graph = 30
version = 10
test = 300
build = 300

[pre_push.guidance]
# Enable enhanced error guidance
enabled = true

# Show documentation links in error messages
show_docs = true

# =============================================================================
# Android Configuration (Skip Fuse)
# =============================================================================

[android]
# Android module (relative to Android/ directory)
module = "app"

# Default build variant
build_variant = "debug"

# Gradle wrapper path
gradlew = "Android/gradlew"
